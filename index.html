<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ö–∞—Ä—Ç–æ—á–µ–∫ –ö–æ—Ä–∞–±–ª–µ–π</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="file-browser-styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Left Panel - Controls -->
        <div class="controls-panel">
            <h1>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ö–∞—Ä—Ç–æ—á–µ–∫ –ö–æ—Ä–∞–±–ª–µ–π</h1>
            
            <div class="control-section">
                <div class="photo-upload">
                    <label>–§–æ—Ç–æ –∫–æ—Ä–∞–±–ª—è (–≥–ª–∞–≤–Ω–æ–µ):</label>
                    <div class="custom-file-input-container">
                        <button class="browse-btn" onclick="openFileBrowserFor('photoUpload', 'main')">üìÇ –ò–∑ –ø–∞–ø–æ–∫</button>
                        <input type="file" id="photoUpload" accept="image/*" style="flex: 1;">
                    </div>
                    <span id="photoStatus">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                </div>
            </div>

            <div class="control-section">
                <div class="photo-upload">
                    <label>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 1 (–≤–µ—Ä—Ö–Ω–µ–µ –ø—Ä–∞–≤–æ–µ):</label>
                    <div class="custom-file-input-container">
                        <button class="browse-btn" onclick="openFileBrowserFor('photo1Upload', 'photo1')">üìÇ –ò–∑ –ø–∞–ø–æ–∫</button>
                        <input type="file" id="photo1Upload" accept="image/*" style="flex: 1;">
                    </div>
                    <span id="photo1Status">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                </div>
            </div>

            <div class="control-section">
                <div class="photo-upload">
                    <label>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 2 (–ø—Ä–∞–≤–æ–µ —Å—Ä–µ–¥–Ω–µ–µ 1):</label>
                    <div class="custom-file-input-container">
                        <button class="browse-btn" onclick="openFileBrowserFor('photo2Upload', 'photo2')">üìÇ –ò–∑ –ø–∞–ø–æ–∫</button>
                        <input type="file" id="photo2Upload" accept="image/*" style="flex: 1;">
                    </div>
                    <span id="photo2Status">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                </div>
            </div>

            <div class="control-section">
                <div class="photo-upload">
                    <label>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 3 (–ø—Ä–∞–≤–æ–µ —Å—Ä–µ–¥–Ω–µ–µ 2):</label>
                    <div class="custom-file-input-container">
                        <button class="browse-btn" onclick="openFileBrowserFor('photo3Upload', 'photo3')">üìÇ –ò–∑ –ø–∞–ø–æ–∫</button>
                        <input type="file" id="photo3Upload" accept="image/*" style="flex: 1;">
                    </div>
                    <span id="photo3Status">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                </div>
            </div>

            <div class="control-section">
                <div class="photo-upload">
                    <label>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 4 (–Ω–∏–∂–Ω–∏–π —Ä—è–¥ 1):</label>
                    <div class="custom-file-input-container">
                        <button class="browse-btn" onclick="openFileBrowserFor('photo4Upload', 'photo4')">üìÇ –ò–∑ –ø–∞–ø–æ–∫</button>
                        <input type="file" id="photo4Upload" accept="image/*" style="flex: 1;">
                    </div>
                    <span id="photo4Status">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                </div>
            </div>

            <div class="control-section">
                <div class="photo-upload">
                    <label>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 5 (–Ω–∏–∂–Ω–∏–π —Ä—è–¥ 2):</label>
                    <div class="custom-file-input-container">
                        <button class="browse-btn" onclick="openFileBrowserFor('photo5Upload', 'photo5')">üìÇ –ò–∑ –ø–∞–ø–æ–∫</button>
                        <input type="file" id="photo5Upload" accept="image/*" style="flex: 1;">
                    </div>
                    <span id="photo5Status">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                </div>
            </div>

            <div class="control-section">
                <div class="photo-upload">
                    <label>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 6 (–Ω–∏–∂–Ω–∏–π —Ä—è–¥ 3):</label>
                    <div class="custom-file-input-container">
                        <button class="browse-btn" onclick="openFileBrowserFor('photo6Upload', 'photo6')">üìÇ –ò–∑ –ø–∞–ø–æ–∫</button>
                        <input type="file" id="photo6Upload" accept="image/*" style="flex: 1;">
                    </div>
                    <span id="photo6Status">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                </div>
            </div>

            <div class="control-section">
                <div class="photo-upload">
                    <label>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 7 (–Ω–∏–∂–Ω–∏–π —Ä—è–¥ 4):</label>
                    <div class="custom-file-input-container">
                        <button class="browse-btn" onclick="openFileBrowserFor('photo7Upload', 'photo7')">üìÇ –ò–∑ –ø–∞–ø–æ–∫</button>
                        <input type="file" id="photo7Upload" accept="image/*" style="flex: 1;">
                    </div>
                    <span id="photo7Status">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
                </div>
            </div>

            <div class="control-section">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ—Ä–∞–±–ª—è:</label>
                <input type="text" id="shipName" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ">
            </div>

            <div class="control-section">
                <label>–ù–∞—Ü–∏—è:</label>
                <div class="option-with-button">
                    <select id="nationSelect"></select>
                    <button class="add-option-btn" onclick="openOptionManager('–ù–∞—Ü–∏—è', 'NATIONS')">+</button>
                </div>
            </div>

            <div class="control-section">
                <label>–£—Ä–æ–≤–µ–Ω—å:</label>
                <div class="option-with-button">
                    <select id="levelSelect"></select>
                    <button class="add-option-btn" onclick="openOptionManager('–£—Ä–æ–≤–µ–Ω—å', 'LEVELS')">+</button>
                </div>
            </div>

            <div class="control-section">
                <label>–ö–ª–∞—Å—Å:</label>
                <div class="option-with-button">
                    <select id="classSelect"></select>
                    <button class="add-option-btn" onclick="openOptionManager('–ö–ª–∞—Å—Å', 'CLASSES')">+</button>
                </div>
            </div>

            <div class="control-section">
                <label>–°—Ç–∞—Ç—É—Å:</label>
                <div class="option-with-button">
                    <select id="statusSelect"></select>
                    <button class="add-option-btn" onclick="openOptionManager('–°—Ç–∞—Ç—É—Å', 'STATUSES')">+</button>
                </div>
            </div>

            <div class="control-section">
                <label>–í–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ–ª—É—á–µ–Ω–∏—è:</label>
                <div class="checkboxes-grid" id="obtainingOptions"></div>
            </div>

            <div class="control-section">
                <label>–†–∞–∑–º–µ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏:</label>
                <select id="outputSize">
                    <option value="1600x1600">1600x1600</option>
                    <option value="3200x3200">3200x3200</option>
                    <option value="4800x4800">4800x4800</option>
                </select>
            </div>

            <div class="control-section">
                <label>–®–∞–±–ª–æ–Ω –∫–∞—Ä—Ç–æ—á–∫–∏:</label>
                <select id="templateType">
                    <option value="new">–ù–æ–≤—ã–π —à–∞–±–ª–æ–Ω (8 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)</option>
                    <option value="old">–°—Ç–∞—Ä—ã–π —à–∞–±–ª–æ–Ω (1 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ)</option>
                </select>
            </div>

            <div class="bottom-controls">
                <button id="generateBtn" class="generate-btn">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</button>
                <div id="progressBar" class="progress-bar" style="display: none;">
                    <div class="progress-bar-fill"></div>
                </div>
            </div>
        </div>

        <!-- Right Panel - Preview and Settings -->
        <div class="preview-panel">
            <div class="preview-container" id="previewContainer">
                <div id="previewText" class="preview-placeholder">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ –¥–ª—è –Ω–∞—á–∞–ª–∞ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞</div>
                <canvas id="previewCanvas" style="display: none;"></canvas>
            </div>

            <div class="tabs-container">
                <div class="tabs-header">
                    <button class="tab-button active" onclick="switchTab('cardSettings')">–ö–∞—Ä—Ç–∞</button>
                    <button class="tab-button" onclick="switchTab('imageSettings')">–ì–ª–∞–≤–Ω–æ–µ —Ñ–æ—Ç–æ</button>
                    <button class="tab-button" onclick="switchTab('image1Settings')">–§–æ—Ç–æ 1</button>
                    <button class="tab-button" onclick="switchTab('image2Settings')">–§–æ—Ç–æ 2</button>
                    <button class="tab-button" onclick="switchTab('image3Settings')">–§–æ—Ç–æ 3</button>
                    <button class="tab-button" onclick="switchTab('image4Settings')">–§–æ—Ç–æ 4</button>
                    <button class="tab-button" onclick="switchTab('image5Settings')">–§–æ—Ç–æ 5</button>
                    <button class="tab-button" onclick="switchTab('image6Settings')">–§–æ—Ç–æ 6</button>
                    <button class="tab-button" onclick="switchTab('image7Settings')">–§–æ—Ç–æ 7</button>
                </div>

                <div class="tab-content active" id="cardSettings">
                    <div class="slider-control">
                        <label>–ú–∞—Å—à—Ç–∞–± –ö–∞—Ä—Ç—ã:</label>
                        <input type="range" id="cardScale" min="0.1" max="3" step="0.01" value="1">
                        <span id="cardScaleValue">1.00</span>
                    </div>
                    <div class="slider-control">
                        <label>–°–¥–≤–∏–≥ X –ö–∞—Ä—Ç—ã:</label>
                        <input type="range" id="cardXOffset" min="-500" max="500" step="1" value="0">
                        <span id="cardXOffsetValue">0</span>
                    </div>
                    <div class="slider-control">
                        <label>–°–¥–≤–∏–≥ Y –ö–∞—Ä—Ç—ã:</label>
                        <input type="range" id="cardYOffset" min="-500" max="500" step="1" value="0">
                        <span id="cardYOffsetValue">0</span>
                    </div>
                    <button class="reset-btn" onclick="resetCardSettings()">–°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>

                <div class="tab-content" id="imageSettings">
                    <div class="slider-control">
                        <label>–ú–∞—Å—à—Ç–∞–±:</label>
                        <input type="range" id="imageScale" min="0.5" max="5" step="0.01" value="1">
                        <span id="imageScaleValue">1.00</span>
                    </div>
                    <div class="slider-control">
                        <label>–°–¥–≤–∏–≥ X:</label>
                        <input type="range" id="imageXOffset" min="-300" max="300" step="1" value="0">
                        <span id="imageXOffsetValue">0</span>
                    </div>
                    <div class="slider-control">
                        <label>–°–¥–≤–∏–≥ Y:</label>
                        <input type="range" id="imageYOffset" min="-300" max="300" step="1" value="0">
                        <span id="imageYOffsetValue">0</span>
                    </div>
                    <button class="reset-btn" onclick="resetImageSettings()">–°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>

                <div class="tab-content" id="image1Settings">
                    <div class="slider-control">
                        <label>–ú–∞—Å—à—Ç–∞–±:</label>
                        <input type="range" id="image1Scale" min="0.5" max="5" step="0.01" value="1">
                        <span id="image1ScaleValue">1.00</span>
                    </div>
                    <div class="slider-control">
                        <label>–°–¥–≤–∏–≥ X:</label>
                        <input type="range" id="image1XOffset" min="-300" max="300" step="1" value="0">
                        <span id="image1XOffsetValue">0</span>
                    </div>
                    <div class="slider-control">
                        <label>–°–¥–≤–∏–≥ Y:</label>
                        <input type="range" id="image1YOffset" min="-300" max="300" step="1" value="0">
                        <span id="image1YOffsetValue">0</span>
                    </div>
                    <button class="reset-btn" onclick="resetImage1Settings()">–°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>

                <div class="tab-content" id="image2Settings">
                    <div class="slider-control">
                        <label>–ú–∞—Å—à—Ç–∞–±:</label>
                        <input type="range" id="image2Scale" min="0.5" max="5" step="0.01" value="1">
                        <span id="image2ScaleValue">1.00</span>
                    </div>
                    <div class="slider-control">
                        <label>–°–¥–≤–∏–≥ X:</label>
                        <input type="range" id="image2XOffset" min="-300" max="300" step="1" value="0">
                        <span id="image2XOffsetValue">0</span>
                    </div>
                    <div class="slider-control">
                        <label>–°–¥–≤–∏–≥ Y:</label>
                        <input type="range" id="image2YOffset" min="-300" max="300" step="1" value="0">
                        <span id="image2YOffsetValue">0</span>
                    </div>
                    <button class="reset-btn" onclick="resetImage2Settings()">–°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>

                <div class="tab-content" id="image3Settings">
                    <div class="slider-control">
                        <label>–ú–∞—Å—à—Ç–∞–±:</label>
                        <input type="range" id="image3Scale" min="0.5" max="5" step="0.01" value="1">
                        <span id="image3ScaleValue">1.00</span>
                    </div>
                    <div class="slider-control">
                        <label>–°–¥–≤–∏–≥ X:</label>
                        <input type="range" id="image3XOffset" min="-300" max="300" step="1" value="0">
                        <span id="image3XOffsetValue">0</span>
                    </div>
                    <div class="slider-control">
                        <label>–°–¥–≤–∏–≥ Y:</label>
                        <input type="range" id="image3YOffset" min="-300" max="300" step="1" value="0">
                        <span id="image3YOffsetValue">0</span>
                    </div>
                    <button class="reset-btn" onclick="resetImage3Settings()">–°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>

                <div class="tab-content" id="image4Settings">
                    <div class="slider-control">
                        <label>–ú–∞—Å—à—Ç–∞–±:</label>
                        <input type="range" id="image4Scale" min="0.5" max="5" step="0.01" value="1">
                        <span id="image4ScaleValue">1.00</span>
                    </div>
                    <div class="slider-control">
                        <label>–°–¥–≤–∏–≥ X:</label>
                        <input type="range" id="image4XOffset" min="-300" max="300" step="1" value="0">
                        <span id="image4XOffsetValue">0</span>
                    </div>
                    <div class="slider-control">
                        <label>–°–¥–≤–∏–≥ Y:</label>
                        <input type="range" id="image4YOffset" min="-300" max="300" step="1" value="0">
                        <span id="image4YOffsetValue">0</span>
                    </div>
                    <button class="reset-btn" onclick="resetImage4Settings()">–°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>

                <div class="tab-content" id="image5Settings">
                    <div class="slider-control">
                        <label>–ú–∞—Å—à—Ç–∞–±:</label>
                        <input type="range" id="image5Scale" min="0.5" max="5" step="0.01" value="1">
                        <span id="image5ScaleValue">1.00</span>
                    </div>
                    <div class="slider-control">
                        <label>–°–¥–≤–∏–≥ X:</label>
                        <input type="range" id="image5XOffset" min="-300" max="300" step="1" value="0">
                        <span id="image5XOffsetValue">0</span>
                    </div>
                    <div class="slider-control">
                        <label>–°–¥–≤–∏–≥ Y:</label>
                        <input type="range" id="image5YOffset" min="-300" max="300" step="1" value="0">
                        <span id="image5YOffsetValue">0</span>
                    </div>
                    <button class="reset-btn" onclick="resetImage5Settings()">–°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>

                <div class="tab-content" id="image6Settings">
                    <div class="slider-control">
                        <label>–ú–∞—Å—à—Ç–∞–±:</label>
                        <input type="range" id="image6Scale" min="0.5" max="5" step="0.01" value="1">
                        <span id="image6ScaleValue">1.00</span>
                    </div>
                    <div class="slider-control">
                        <label>–°–¥–≤–∏–≥ X:</label>
                        <input type="range" id="image6XOffset" min="-300" max="300" step="1" value="0">
                        <span id="image6XOffsetValue">0</span>
                    </div>
                    <div class="slider-control">
                        <label>–°–¥–≤–∏–≥ Y:</label>
                        <input type="range" id="image6YOffset" min="-300" max="300" step="1" value="0">
                        <span id="image6YOffsetValue">0</span>
                    </div>
                    <button class="reset-btn" onclick="resetImage6Settings()">–°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>

                <div class="tab-content" id="image7Settings">
                    <div class="slider-control">
                        <label>–ú–∞—Å—à—Ç–∞–±:</label>
                        <input type="range" id="image7Scale" min="0.5" max="5" step="0.01" value="1">
                        <span id="image7ScaleValue">1.00</span>
                    </div>
                    <div class="slider-control">
                        <label>–°–¥–≤–∏–≥ X:</label>
                        <input type="range" id="image7XOffset" min="-300" max="300" step="1" value="0">
                        <span id="image7XOffsetValue">0</span>
                    </div>
                    <div class="slider-control">
                        <label>–°–¥–≤–∏–≥ Y:</label>
                        <input type="range" id="image7YOffset" min="-300" max="300" step="1" value="0">
                        <span id="image7YOffsetValue">0</span>
                    </div>
                    <button class="reset-btn" onclick="resetImage7Settings()">–°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Option Manager Modal -->
    <div id="optionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–ø—Ü–∏—è–º–∏</h2>
                <button class="close-btn" onclick="closeOptionManager()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="add-option-section">
                    <label>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:</label>
                    <input type="text" id="newOptionInput">
                    <button onclick="addNewOption()">–î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
                <div class="options-list" id="optionsList"></div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
    <!-- File Browser Modal -->
    <div id="fileBrowserModal">
        <div class="file-browser-container">
            <div class="file-browser-header">
                <div class="file-browser-title">üìÅ –í—ã–±—Ä–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ –ø–∞–ø–æ–∫</div>
                <button class="file-browser-close" onclick="fileBrowser.close()">&times;</button>
            </div>
            
            <div class="file-browser-navigation">
                <button class="nav-btn" id="backBtn" onclick="fileBrowser.goBack()">‚¨Ö –ù–∞–∑–∞–¥</button>
                <div class="file-browser-breadcrumb" id="fileBrowserBreadcrumb">–ì–ª–∞–≤–Ω–∞—è</div>
            </div>
            
            <div class="file-browser-body">
                <div id="fileBrowserContent"></div>
            </div>
            
            <div class="file-browser-footer">
                <button class="device-browser-btn" onclick="fileBrowser.openDeviceBrowser()">üì± –û–±–∑–æ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</button>
            </div>
        </div>
    </div>

    <script src="file-browser.js"></script>
    <script src="app.js"></script>
    <script>
        // Global function to open file browser for specific input
        let currentInputId = null;
        let currentPhotoType = null;

        function openFileBrowserFor(inputId, photoType) {
            currentInputId = inputId;
            currentPhotoType = photoType;
            
            fileBrowser.open(function(imageData) {
                if (imageData === null) {
                    // User wants to use device browser
                    document.getElementById(currentInputId).click();
                } else {
                    // User selected an image from the file browser
                    // Create a File object from the blob
                    const file = new File([imageData.blob], imageData.name, { type: imageData.blob.type });
                    const event = { target: { files: [file] } };
                    handlePhotoUpload(event, currentPhotoType);
                }
            });
        }
    </script>
</body>
</html>